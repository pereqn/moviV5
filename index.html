<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>MOVI ‚Äî V1.3.5 (full fix + hotfix)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <header>
      <div class="topbar">
        <button class="iconbtn sm" id="profileBtn" title="–ü—Ä–æ—Ñ–∏–ª—å" aria-label="–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å" data-top="profile">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="1.8"></circle>
            <path d="M5 20a7 7 0 0 1 14 0" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path>
          </svg>
        </button>
        <div class="title" id="pageTitle">–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</div>
        <div class="righticons">
          <button class="iconbtn sm" id="settingsBtn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" aria-label="–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏" data-top="settings">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" stroke="currentColor" stroke-width="2"/>
              <path d="M19.4 15a7.97 7.97 0 0 0 .1-1 7.97 7.97 0 0 0-.1-1l2.1-1.6-2-3.4-2.5 1a8 8 0 0 0-1.7-1l-.4-2.7h-4l-.4-2.7a8 8 0  0 0-1.7-1l-2.5-1-2 3.4L4.6 13a7.97 7.97 0 0 0-.1 1 7.97 7.97 0 0 0 .1 1l-2.1 1.6 2 3.4 2.5-1a8 8 0 0 0 1.7 1l.4 2.7h4l.4-2.7a8 8 0 0 0 1.7-1l2.5 1 2-3.4-2.1-1.6z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="iconbtn" id="calendarBtn" title="–ö–∞–ª–µ–Ω–¥–∞—Ä—å" aria-label="–û—Ç–∫—Ä—ã—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <rect x="3" y="5" width="18" height="16" rx="3" stroke="currentColor" stroke-width="1.6"></rect>
              <path d="M8 3v4M16 3v4M3 10h18" stroke="currentColor" stroke-width="1.6"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="version">V1.3.5</div>
      <div class="datestrip" id="dateStrip" aria-label="–î–Ω–∏ (—Å–≤–∞–π–ø)"></div>
    </header>

    <main class="content">
      <!-- AUTH FLOW -->
      <section class="view active" id="view-start">
        <div class="start">
          <h1 class="brand">MOVI</h1>
          <p class="subtitle">DriverBot</p>
          <div class="start-actions">
            <button class="btn primary lg" id="goRegister">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            <button class="btn ghost lg" id="goLogin">–í–æ–π—Ç–∏</button>
          </div>
        </div>
      </section>

      <section class="view" id="view-register">
        <div class="authcard">
          <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
          <div class="grid">
            <input id="reg_name" placeholder="–ò–º—è" autocomplete="name">
            <input id="reg_phone" placeholder="+7 ..." inputmode="tel" autocomplete="tel">
            <div class="passwrap">
              <input id="reg_pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 8, EN, 1 –∑–∞–≥–ª–∞–≤–Ω–∞—è)" autocomplete="new-password">
              <button class="eye" data-for="reg_pass" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅ</button>
            </div>
            <div class="passwrap">
              <input id="reg_pass2" type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="new-password">
              <button class="eye" data-for="reg_pass2" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅ</button>
            </div>
            <ul class="hints" id="reg_hints">
              <li data-k="len">–ù–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤</li>
              <li data-k="latin">–¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞ / —Ü–∏—Ñ—Ä—ã</li>
              <li data-k="upper">–ú–∏–Ω–∏–º—É–º 1 –∑–∞–≥–ª–∞–≤–Ω–∞—è</li>
              <li data-k="match">–ü–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç</li>
            </ul>
          </div>
          <div class="actions">
            <button class="btn primary" id="registerSubmit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
          </div>
          <div class="muted switch">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <button class="link" id="switchToLogin">–í–æ–π—Ç–∏</button></div>
        </div>
      </section>

      <section class="view" id="view-login">
        <div class="authcard">
          <h2>–í—Ö–æ–¥</h2>
          <div class="grid">
            <input id="login_phone" placeholder="+7 ..." inputmode="tel" autocomplete="tel">
            <div class="passwrap">
              <input id="login_pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password">
              <button class="eye" data-for="login_pass" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅ</button>
            </div>
          </div>
          <div class="actions">
            <button class="btn primary" id="loginSubmit">–í–æ–π—Ç–∏</button>
          </div>
          <div class="muted switch">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <button class="link" id="switchToRegister">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button></div>
        </div>
      </section>

      <section class="view" id="view-home">
        <div class="list" id="ordersList"></div>
        <div class="empty" id="emptyDay" style="display:none">–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –∑–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</div>
      </section>

      <section class="view" id="view-requests">
        <div class="hint">–ó–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤. –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å –∏ –ø—Ä–∏–Ω—è—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å.</div>
        <div class="list" id="requestsList"></div>
        <div class="empty" id="emptyReq" style="display:none">–ó–∞—è–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç.</div>
      </section>

      <section class="view" id="view-settings">
        <div class="settings">
          <div class="setcard">
            <div class="setmeta">
              <div class="setting-title">–¢–µ–º–∞</div>
              <div class="setting-desc">–°–≤–µ—Ç–ª–∞—è, –¢—ë–º–Ω–∞—è –∏–ª–∏ –ê–≤—Ç–æ (–ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Å–∏—Å—Ç–µ–º—É)</div>
            </div>
            <select id="themeSelect">
              <option value="auto">–ê–≤—Ç–æ</option>
              <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
              <option value="dark">–¢—ë–º–Ω–∞—è</option>
            </select>
          </div>
          <div class="setcard">
            <div class="setmeta">
              <div class="setting-title">–ì–æ—Ä–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</div>
              <div class="setting-desc">–ü–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∞–¥—Ä–µ—Å –∑–∞–∫–∞–∑–æ–≤</div>
            </div>
            <input id="cityInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞">
          </div>
          <div class="setcard">
            <div class="setmeta">
              <div class="setting-title">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤</div>
              <div class="setting-desc">–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –≤ –∑–∞–∫–∞–∑–µ</div>
            </div>
            <select id="callAppSelect">
              <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
              <option value="whatsapp">WhatsApp</option>
              <option value="telegram">Telegram</option>
            </select>
          </div>
          <div class="setcard">
            <div class="setmeta">
              <div class="setting-title">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç</div>
              <div class="setting-desc">–ú–∞—Ä—à—Ä—É—Ç –ø–æ –∞–¥—Ä–µ—Å—É: Google, –Ø–Ω–¥–µ–∫—Å –∏–ª–∏ 2–ì–ò–°</div>
            </div>
            <select id="mapAppSelect">
              <option value="google">Google Maps</option>
              <option value="yandex">Yandex Maps</option>
              <option value="2gis">2GIS</option>
            </select>
          </div>
        </div>
      </section>

      <section class="view" id="view-profile">
        <div class="profile">
          <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
          <div class="grid">
            <input id="p_name" placeholder="–ò–º—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è">
            <input id="p_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (+7 ...)">
          </div>
          <div class="actions" style="margin-top:8px">
            <button class="btn primary" id="saveProfileBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
          </div>

          <h4 style="margin-top:18px">–§–∏–ª—å—Ç—Ä –∑–∞–∫–∞–∑–æ–≤</h4>
          <div class="filterbar" id="filterBar" role="tablist" aria-label="–§–∏–ª—å—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞">
            <button class="fchip active" data-filter="all" role="tab" aria-selected="true">–í—Å–µ</button>
            <button class="fchip" data-filter="active" role="tab" aria-selected="false">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
            <button class="fchip" data-filter="done" role="tab" aria-selected="false">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</button>
          </div>

          <h4 style="margin-top:18px">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
          <div class="statgrid" id="profileStats"></div>

          <h4 style="margin-top:18px">–ü–æ –º–µ—Å—è—Ü–∞–º</h4>
          <div class="monthstats" id="monthlyStats"></div>
        </div>
      </section>

      <section class="view" id="view-calendar">
        <div class="calendar-wrap">
          <div class="cal-head">
            <button class="btn ghost cal-nav" id="calPrev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü">‚Üê</button>
            <div class="cal-title" id="calTitle">–ú–µ—Å—è—Ü –ì–æ–¥</div>
            <button class="btn ghost cal-nav" id="calNext" aria-label="–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü">‚Üí</button>
          </div>
          <div class="cal-card">
            <div class="cal-weekdays">
              <div>–ü–Ω</div><div>–í—Ç</div><div>–°—Ä</div><div>–ß—Ç</div><div>–ü—Ç</div><div>–°–±</div><div>–í—Å</div>
            </div>
            <div class="cal-grid" id="calGrid"></div>
          </div>
          <div class="actions" style="margin-top:12px">
            <button class="btn" id="backToHome">–ù–∞–∑–∞–¥</button>
          </div>
        </div>
      </section>
    </main>

    <nav class="nav">
      <div class="dock">
        <button class="navbtn circ active" data-nav="home" title="–ì–ª–∞–≤–Ω–∞—è (–ø–æ –¥–Ω—è–º)">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="navbtn fab" id="addOrderBtn" title="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑" aria-label="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="navbtn circ" data-nav="requests" title="–ó–∞—è–≤–∫–∏">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 12l3-7h12l3 7v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7z" stroke="currentColor" stroke-width="2"/>
            <path d="M7 12h3a2 2 0 0 0 4 0h3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="safe-bottom"></div>
    </nav>
  </div>

  <!-- Modals -->
  <div class="modal" id="orderModal" aria-hidden="true">
    <div class="sheet">
      <h3>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</h3>
      <div class="grid">
        <input id="f_name" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
        <input id="f_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (—Ñ–æ—Ä–º–∞—Ç –†–§)">
        <div class="row">
          <input id="f_street" placeholder="–£–ª–∏—Ü–∞">
          <input id="f_house" placeholder="–î–æ–º">
        </div>
        <div class="row">
          <input id="f_apt" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞">
          <input id="f_time" type="time" placeholder="–í—Ä–µ–º—è">
        </div>
        <div class="row">
          <input id="f_price" type="number" min="0" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)">
          <select id="f_type">
            <option value="–º–µ–±–µ–ª—å">–ú–µ–±–µ–ª—å</option>
            <option value="—Ç–µ—Ö–Ω–∏–∫–∞">–¢–µ—Ö–Ω–∏–∫–∞</option>
            <option value="–ø—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
          </select>
        </div>
        <div class="row">
          <select id="f_gate">
            <option value="–Ω–µ—Ç">–®–ª–∞–≥–±–∞—É–º: –ù–µ—Ç</option>
            <option value="–¥–∞">–®–ª–∞–≥–±–∞—É–º: –î–∞</option>
          </select>
          <select id="f_elevator">
            <option value="–Ω–µ—Ç">–õ–∏—Ñ—Ç: –ù–µ—Ç</option>
            <option value="–¥–∞">–õ–∏—Ñ—Ç: –î–∞</option>
          </select>
        </div>
        <div class="row">
          <input id="f_company" placeholder="–ö–æ–º–ø–∞–Ω–∏—è (–Ω–µ–æ–±—è–∑.)">
          <input id="f_contact" placeholder="–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ (–Ω–µ–æ–±—è–∑.)">
        </div>
        <textarea id="f_customer_note" placeholder="–ó–∞–º–µ—Ç–∫–∞ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ (–Ω–µ–æ–±—è–∑.)"></textarea>
        <textarea id="f_comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)"></textarea>
        <input type="date" id="f_date" placeholder="–î–∞—Ç–∞">
      </div>
      <div class="actions">
        <button class="btn ghost" data-close="orderModal">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn primary" id="saveOrder">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <div class="modal" id="editModal" aria-hidden="true">
    <div class="sheet">
      <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑</h3>
      <div class="grid">
        <input id="e_name" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
        <input id="e_phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (—Ñ–æ—Ä–º–∞—Ç –†–§)">
        <div class="row">
          <input id="e_street" placeholder="–£–ª–∏—Ü–∞">
          <input id="e_house" placeholder="–î–æ–º">
        </div>
        <div class="row">
          <input id="e_apt" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞">
          <input id="e_time" type="time" placeholder="–í—Ä–µ–º—è">
        </div>
        <div class="row">
          <input id="e_price" type="number" min="0" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)">
          <select id="e_type">
            <option value="–º–µ–±–µ–ª—å">–ú–µ–±–µ–ª—å</option>
            <option value="—Ç–µ—Ö–Ω–∏–∫–∞">–¢–µ—Ö–Ω–∏–∫–∞</option>
            <option value="–ø—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
          </select>
        </div>
        <div class="row">
          <select id="e_gate">
            <option value="–Ω–µ—Ç">–®–ª–∞–≥–±–∞—É–º: –ù–µ—Ç</option>
            <option value="–¥–∞">–®–ª–∞–≥–±–∞—É–º: –î–∞</option>
          </select>
          <select id="e_elevator">
            <option value="–Ω–µ—Ç">–õ–∏—Ñ—Ç: –ù–µ—Ç</option>
            <option value="–¥–∞">–õ–∏—Ñ—Ç: –î–∞</option>
          </select>
        </div>
        <div class="row">
          <input id="e_company" placeholder="–ö–æ–º–ø–∞–Ω–∏—è (–Ω–µ–æ–±—è–∑.)">
          <input id="e_contact" placeholder="–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ (–Ω–µ–æ–±—è–∑.)">
        </div>
        <textarea id="e_customer_note" placeholder="–ó–∞–º–µ—Ç–∫–∞ –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ (–Ω–µ–æ–±—è–∑.)"></textarea>
        <textarea id="e_comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)"></textarea>
        <input type="date" id="e_date" placeholder="–î–∞—Ç–∞">
      </div>
      <div class="actions">
        <button class="btn danger" id="deleteOrder">–£–¥–∞–ª–∏—Ç—å</button>
        <div style="flex:1"></div>
        <button class="btn ghost" data-close="editModal">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn primary" id="updateOrder">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"><span></span></div>

  <script src="app.js"></script>
</body>
</html>